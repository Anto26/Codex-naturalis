---
title: Model diagram
---
classDiagram
    Match --> GameDeck
    Match --> MatchState
    Match --> DrawSource
    Match -- Player
    MatchState <|-- WaitState
    MatchState <|-- SetupState
    MatchState <|-- NextTurnState
    MatchState <|-- ChooseInitialSideState
    MatchState <|-- ChooseSecretObjectiveState
    MatchState <|-- AfterMoveState
    MatchState <|-- AfterDrawState
    MatchState <|-- FinalState

    Card <|-- InitialCard
    Card <|-- PlayableCard
    GameDeck --> Card
    PlayableCard <|-- ResourceCard
    PlayableCard <|-- GoldCard

    Requirement <|-- QuantityRequirement
    Requirement <|-- PositionRequirement
    Requirement <-- Objective
    QuantityRequirement <-- GoldCard

    Board --> PlacedCard
    Board -- PlacementOutcome
    Player --> Board
    Player --> Objective
    CardFace <-- Card
    Symbol <-- CardFace
    Player --> Color
    Board --> Requirement
    %%Side <-- Player
    %%Side <-- Match
    Side <-- PlacedCard
    Corner <-- CardFace
    %%Symbol <-- GoldCard
    %% DrawSource <-- Player



    class Symbol {
        <<Enumeration>>
        ANIMAL
        PLANT
        INSECT
        FUNGUS
        FEATHER
        INKWELL
        PARCHMENT
        EMPTY_CORNER
        FULL_CORNER
        CORNER_OBJ
    }

    class Corner {
      <<Enumeation>>
      TOP_LEFT
      TOP_RIGHT
      BOTTOM_LEFT
      BOTTOM_RIGHT
    }

    class CardFace {
        <<Record>>
        - topLeft: Symbol
        - topRight: Symbol
        - bottomLeft: Symbol
        - bottomRight: Symbol
        - center: Set~Symbol~
        + CardFace(Symbol topLeft, Symbol topRight, Symbol bottomLeft, Symbol bottomRight, Set~Symbol~ center)
        + getCorner(Corner corner) Symbol
        + getCenter() Set~Symbol~
    }

    class Card {
        <<Abstract>>
        # sides : Map~Side, CardFace~
        + getSide(Side side) CardFace
    }

    class PlayableCard {
        <<Abstract>>
        # reign: Symbol
        # points: int
        + getReign() Symbol
    }

    class InitialCard {
        + InitialCard(CardFace front, CardFace back)
    }

    class ResourceCard {
        + ResourceCard(CardFace front, CardFace back, int points)
        + getPoints() : int
    }

    class GoldCard {
        - multiplier: Symbol
        - req: QuantityRequirement
        + GoldCard(CardFace front, CardFace back, int points, Symbol multiplier, QuantityRequirement req)
        + getMultiplier() Symbol
        + getRequirement() QuantityRequirement
        + calculatePoints(Board board) int
    }

    class Requirement {
        <<Abstract>>
        + isSatisfied(Board board) bool
    }

    class QuantityRequirement {
        - reqs : Map~Integer, Symbol~
        + QuantityRequirement(Symbol simbol, Integer quantity)
        + isSatisfied(Board board) bool
    }

    class PositionRequirement {
        - reqs: Map&ltPair&ltInteger, Integer&gt, Color&gt
        + PositionRequirement(Map&ltPair&ltInteger, Integer&gt, Color&gt)
        + isSatisfied(Board board) bool
    }
    class Objective {
        - points: int
        - req: Requirement
        + Objective(int points, Requirement req)
        + getPoints() int
        + getRequirement() Requirement
    }
    class Player {
        - nickname: String
        - match: Match
        - points: Int
        - board: Board
        - color: Color
        - objective: Objective

        + Player(String nickname, Match match)
        + playCard(Pair<Integer, Integer> coord, PlayableCard card, Side side) void
        + drawCard(DrawSource draw) void
        + chooseObjective(Objective objective) void
        + chooseInitialSide(Side side) void
        + getBoard() Board
        + getPoints() int
        + getSecretObjective() Objective
        + getColor() Color
        + getNickname() String
        # setColor() void
    }
    class Color{
        <<Enumeration>>
        RED
        BLUE
        GREEN
        YELLOW
    }
    class Side{
        <<Enumeration>>
        FRONT
        BACK
    }
    class Board {
        - currentHand: List~PlayableCard~
        - placed: Map&ltPair&ltInteger,Integer&gt, PlacedCard&gt
        - availableResources: Map~Symbol, Integer~

        + Board()
        + getCurrentHand() List~PlayableCard~
        + getAvailableResources() Map~Symbol, Integer~
        # getPlacedMap() Map&ltPair&ltInteger,Integer&gt, PlacedCard&gt
        # addHandCard(PlayableCard card) void
        # removeHandCard(PlayableCard card) void
        # setInitialSide(Side side) void
        # placeCard(Pair~Integer, Integer~, PlayableCard card, Side side, int turn) int
        # setInitialCard(InitialCard card) void
        + verifyCardPlacement(Pair~Integer, Integer~ coords, Card card, Side side) PlacementOutcome
    }
    class PlacedCard {
        <<Record>>
        - card: Card
        - turn: int
        + PlacedCard(Card card, int turn)
        + getCard() Card
        + getTurn() int
    }

    class Match {
        - players: list~Players~
        - maxPlayers: int
        - currState: MatchState
        - currentPlayer: Player
        - initialsDeck: GameDeck~InitialCard~
        - resourcesDeck: GameDeck~ResourceCard~
        - goldsDeck: GameDeck~GoldCard~
        - objectivesDeck: GameDeck~Objective~
        - visibleGolds: Pair~GoldCard, GoldCard~
        - visibleResources: Pair~ResourceCard, ResourceCard~
        - visibleObjectives: Pair~Objective, Objective~
        - currentProposedObjectives: Pair~Objective, Objective~
        - started: bool
        - lastTurn: bool
        - finished: bool

        + Match(int maxPlayers, resourceDeck ) void
        + isFull() bool
        + isStarted() bool
        + isFinished() bool
        + addPlayer(Player player) void
        + removePlayer(Player player) void
        + getCurrentPlayer() Player
        + getPlayers() List~Player~
        # getPoints() int
        # addPoints() void
        # chooseSecretObjective(Objective obj) void
        # proposeSecretObjectives() Pair~Objective, Objective~
        # makeMove(Pair~Integer, Integer~ coords, PlayableCard card, Side side) void
        # drawCard(DrawSource draw) PlayableCard
        # chooseInitialSide(Side side) void
        # doStart() void
        # doFinish() void
        # setState() void
        # setupDecks() void
        # setupPlayers() void
        # setupBoards() void
        # nextPlayer() void

    }
    class DrawSource {
        <<Enumeration>>
        GOLDS_DECK,
        RESOURCES_DECK,
        FIRST_VISIBLE_GOLDS,
        SECOND_VISIBLE_GOLDS,
        FIRST_VISIBLE_RESOURCES,
        SECOND_VISIBLE_RESOURCES
    }

    class MatchState {
        <<Abstract>>
        + match: Match
        + MatchState(Match match)
        + transition() void
        + addPlayer() void
        + removePlayer() void
	    + proposeSecretObjectives() void
	    + chooseSecretObjective() void
        + chooseInitialSide(Side side) void
	    + makeMove() void
	    + drawCard() void

    }

    class WaitState{
        + WaitState(Match match) void
        + transition() void
        + addPlayer() void
        + removePlayer() void
    }
    class SetupState{
        + SetupState(Match match) void
        + transition() void

    }
    class NextTurnState {
        + NextTurnState(Match match) void
        + proposeSecretObjectives() void
        + makeMove() void
        + transition() void
    }
    class ChooseInitialSideState{ 
        + ChooseInitialSideState(Match match) void
        + chooseInitialSide(Side side) void
        + transition() void
    }
    class ChooseSecretObjectiveState {
        + ChooseSecretObjectiveState() void
        + chooseSecretObjective() void
        + transition() void
    }

    class AfterMoveState {
        + AfterMoveState() void
        + drawCard() void
        + transition() void
    }

    class AfterDrawState {
        + AfterDrawState() void
        + transition() void
    }

    class FinalState{
        + FinalState() void
        + transition() void
    }

    class PlacementOutcome {
        <<Enumeration>>
        VALID,
        INVALID_COORDS,
        INVALID_ENOUGH_RESOURCES,
    } 
    class GameDeck {
        <<Generics>>
        - int size
        - cardsList: List~U~
        + GameDeck(int size)
        + add(U card) void
        + pop() U
        + shuffle() void
        + isEmpty() void
    }

